# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

* [`managedmac`](#managedmac): Module initializer.
* [`managedmac::activedirectory`](#managedmacactivedirectory): Binds an OS X machine to Active Directory and manages that configuration.
* [`managedmac::cron`](#managedmaccron): Dynamically create Puppet Cron resources using the Puppet built-in
'create_resources' function.
* [`managedmac::desktop`](#managedmacdesktop): Leverages the Mobileconfig type to deploy a Desktop Picture profile.
* [`managedmac::energysaver`](#managedmacenergysaver): Leverages the Mobileconfig type and provider to configure Energy Saver
settings for Desktops and Laptops.
* [`managedmac::execs`](#managedmacexecs): Dynamically create Puppet Exec resources using the Puppet built-in
'create_resources' function.
* [`managedmac::files`](#managedmacfiles): == Class: managedmac::files  Dynamically create Puppet File resources using the Puppet built-in 'create_resources' function.  We do some vali
* [`managedmac::filevault`](#managedmacfilevault): == Class: managedmac::filevault  Leverages the Mobileconfig type to deploy a FileVault 2 profile. It provides only a subset of the options av
* [`managedmac::groups`](#managedmacgroups): == Class: managedmac::groups  Dynamically create Puppet Macgroup resources using the Puppet built-in 'create_resources' function.  We do some
* [`managedmac::loginhook`](#managedmacloginhook): == Class: managedmac::loginhook  Simple class for activating or deactivating OS X loginhooks and specifying a directory of scripts to execute
* [`managedmac::loginwindow`](#managedmacloginwindow): Then simply, create a manifest and include the class...   # Example: my_manifest.pp  include managedmac::loginwindow  If you just wish to tes
* [`managedmac::logouthook`](#managedmaclogouthook): == Class: managedmac::logouthook  Simple class for activating or deactivating OS X logouthooks and specifying a directory of scripts to execu
* [`managedmac::mcx`](#managedmacmcx): == Class: managedmac::mcx  Leverages the Puppet MCX type to deploy some options not available in Configuration Profiles. If any parameters fo
* [`managedmac::mobileconfigs`](#managedmacmobileconfigs): == Class: managedmac::mobileconfigs  Dynamically create Puppet Mobileconfig resources using the Puppet built-in 'create_resources' function. 
* [`managedmac::mounts`](#managedmacmounts): == Class: managedmac::mounts  Uses Mobileconfig type to define drives to map at login time.  === Parameters  [*urls*]   A list of network mou
* [`managedmac::ntp`](#managedmacntp): == Class: managedmac::ntp  Activates and configures NTP synchronization.  === Parameters  This class takes a two parameters:  [*enable*]   Wh
* [`managedmac::portablehomes`](#managedmacportablehomes): == Class: managedmac::portablehomes  Leverages the Mobileconfig type to deploy a Mobility profile capable of supporting portable home directo
* [`managedmac::propertylists`](#managedmacpropertylists): == Class: managedmac::propertylists  Dynamically create Puppet Propertylist resources using the Puppet built-in 'create_resources' function. 
* [`managedmac::remotemanagement`](#managedmacremotemanagement): == Class: managedmac::remotemanagement  Leverages the Remotemanagement type to manage and configure the Apple Remote Desktop service.  === Pa
* [`managedmac::screensharing`](#managedmacscreensharing): == Class: managedmac::screensharing  Activates and controls the OS X ScreenSharing service.  IMPORTANT: You cannot enable RemoteManagement an
* [`managedmac::security`](#managedmacsecurity): == Class: managedmac::security  Leverages the Mobileconfig type to deploy a Security profile.  All of the parameter defaults are 'undef' so i
* [`managedmac::softwareupdate`](#managedmacsoftwareupdate): == Class: managedmac::softwareupdate  Abstracts com.apple.SoftwareUpdate PayloadType using Mobileconfig type and controls keys in global com.
* [`managedmac::sshd`](#managedmacsshd): == Class: managedmac::sshd  Activates and controls the OS X SSH daemon.  === Parameters  [*enable*]   Whether to enable the service or not, t
* [`managedmac::users`](#managedmacusers): == Class: managedmac::users  Dynamically create Puppet User resources using the Puppet built-in 'create_resources' function.  We do some vali

**Defined types**

* [`managedmac::hook`](#managedmachook): Definition: managedmac::hook  This class installs a master login or logout hook.  Parameters: - $enable Whether to activate the master hook o

**Resource types**

* [`dsconfigad`](#dsconfigad): %q(Manage OS X Active Directory binding and configuration options.    A custom Puppet type for scripted binding and AD plugin configuration  
* [`macgroup`](#macgroup): %q(A drop-in replacement for the built-in Puppet Type: Group    A custom Puppet type for configuring and managing OS X groups.    Similar to 
* [`mobileconfig`](#mobileconfig): Dynamically create and manage OS X .mobileconfig profiles  A custom Puppet type for delivering policy via OS X profiles.  When you define a M
* [`property_list`](#property_list): Puppet type for managing OS X PropertyLists.  Suitable for the creation and management of configuration files and OS X preference domain stor
* [`remotemanagement`](#remotemanagement): Manage Mac OS X Apple Remote Desktop client settings. remotemanagement { 'apple_remote_desktop':   ensure            => 'running',   allow_al

**Functions**

* [`compact_hash`](#compact_hash): Hash keys with empty or undef values are deleted. Returns resulting Hash.
* [`portablehomes_excluded_items`](#portablehomes_excluded_items): Returns a Array of properly formatted excludeItems Hashes.
* [`portablehomes_synced_folders`](#portablehomes_synced_folders): Returns a Array of properly formatted syncedFolder Hashes.
* [`process_dsconfigad_params`](#process_dsconfigad_params): Returns a Hash for Dsconfigad type suitable for consumption by `create_resources`. It will compact the data and transform Booleans into the p
* [`process_mcx_options`](#process_mcx_options): Returns a com.apple.ManagedClient.preferences Payload.
* [`process_mobileconfig_params`](#process_mobileconfig_params): Returns a Payload Array for Mobileconfig type. Accepts a Hash. Each key is a string representing the PayloadType key. The value of said key i
* [`process_mounts`](#process_mounts): Returns a Payload Hash of properly formatted mounts. Expects Array.
* [`validate_raw_constructor`](#validate_raw_constructor): Specialized function used to validate raw constructor class resource hashes. Expects the value of each key in the resource param to be Hash. 
* [`version_compare`](#version_compare): Expects a pair of version strings. Returns Fixnum: -1 (<), 0 (=) or 1 (>)

**Data types**

* [`Managedmac::Enabledisable`](#managedmacenabledisable): Enable/Disable data type
* [`Managedmac::Mountstyle`](#managedmacmountstyle): Mount style for user home directory
* [`Managedmac::Namespace`](#managedmacnamespace): Allowed namespace for ad
* [`Managedmac::Packetencrypt`](#managedmacpacketencrypt): Packet encryption type
* [`Managedmac::Packetsign`](#managedmacpacketsign): Packet signing type
* [`Managedmac::Universalboolean`](#managedmacuniversalboolean): Universal boolean. Can take true/false as string or type

## Classes

### managedmac

Module initializer.

#### Examples

##### 

```puppet
include managedmac

class { managedmac: }
```

### managedmac::activedirectory

Then simply, create a manifest and include the class...

* **Note** IMPORTANT: USING PROVIDERS
This class now only supprts the `dsconfigad` provider. `mobileconfig` has
been deprecacted.  The `dsconfigad` provider abstracts Apple's
'/usr/sbin/dsconfigad' utility and passes the specified parameters to it.

As such, the Dsconfigad provider WILL NOT destroy an Active Directory
binding when changing simple AD plugin configuration values.

#### Examples

##### defaults.yaml

```puppet
---
managedmac::activedirectory::enable: true
managedmac::activedirectory::provider: dsconfigad
managedmac::activedirectory::hostname: ad.apple.com
managedmac::activedirectory::username: some_account
managedmac::activedirectory::password: some_password
managedmac::activedirectory::computer: some_computer
managedmac::activedirectory::evaluate: "%{::domain_available?}"
managedmac::activedirectory::mount_style: afp
managedmac::activedirectory::create_mobile_account_at_login: true
managedmac::activedirectory::warn_user_before_creating_ma: false
managedmac::activedirectory::force_home_local: true
managedmac::activedirectory::domain_admin_group_list:
   - APPLE\Domain Admins
   - APPLE\Enterprise Admins
managedmac::activedirectory::trust_change_pass_interval_days: 0
```

##### my_manifest.pp

```puppet
include managedmac::activedirectory
```

##### Testing functionality

```puppet
If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::activedirectory':
    provider                        => 'dsconfigad',
    evaluate                        => $::domain_available?,
    hostname                        => 'foo.ad.com',
    username                        => 'some_account',
    password                        => 'some_password',
    computer                        => 'some_computer',
    mount_style                     => 'afp',
    trust_change_pass_interval_days => 0,
 }
```

#### Parameters

The following parameters are available in the `managedmac::activedirectory` class.

##### `enable`

Data type: `Optional[Boolean]`

Whether to apply the resource or remove it. Pass a Symbol or a String.

Default value: `undef`

##### `evaluate`

Data type: `Optional[Variant[Stdlib::Yes_no,Managedmac::Universalboolean]]`

A seatbelt intended to prevent the Active Directory configuration
from being removed or modified. Any administrator defined condition
can serve as the basis for comparison.
Pass: 'yes', 'no', 'true' or 'false'
If 'no' or 'false', the mobileconfig resource is not evaluated and a
warning is produced. Useful in conjunction with a custom Facter fact.

Default value: `undef`

##### `provider`

Data type: `String[1]`

String representation of the provider type.

Default value: 'dsconfigad'

##### `force`

Data type: `Managedmac::Enabledisable`

Force the process (i.e., join the existing account or remove the
binding. Accepts: enable or disable

Default value: 'enable'

##### `leave`

Data type: `Managedmac::Enabledisable`

*** BROKEN! ***
* Using this feature will procude a Segmentation Fault error in the
* dsconfigad utility. This is an Apple bug. If it were to work it would
* perform the following function...
***

Leaves the current domain (preserving the computer record in the
directory).

Default value: 'disable'

##### `hostname`

Data type: `Optional[String[1]]`

The Active Directory domain to join. This parameter is required when
:enabled is true.

Default value: `undef`

##### `username`

Data type: `Optional[String[1]]`

User name of the account used to join the domain. This parameter is
required when :enabled is true.

Default value: `undef`

##### `password`

Data type: `Optional[String[1]]`

Password of the account used to join the domain. This parameter is
required when :enabled is true.

Default value: `undef`

##### `computer`

Data type: `Optional[String[1]]`

The "computerid" to add the specified Domain. Required parameter.

Default value: `undef`

##### `organizational_unit`

Data type: `Optional[String[1]]`

The organizational unit (OU) where the joining computer object is added

Default value: `undef`

##### `mount_style`

Data type: `Optional[Managedmac::Mountstyle]`

Network home protocol to use: "afp" or "smb"

Default value: `undef`

##### `sharepoint`

Data type: `Optional[Managedmac::Enabledisable]`

Enable or disable mounting of the network home as a sharepoint.

Default value: `undef`

##### `default_user_shell`

Data type: `Optional[Stdlib::Absolutepath]`

Default user shell; e.g. /bin/bash

Default value: `undef`

##### `map_uid_attribute`

Data type: `Optional[String[1]]`

Map UID to attribute

Default value: `undef`

##### `map_gid_attribute`

Data type: `Optional[String[1]]`

Map user GID to attribute

Default value: `undef`

##### `map_ggid_attribute`

Data type: `Optional[String[1]]`

Map group GID to attribute

Default value: `undef`

##### `authority`

Data type: `Optional[Managedmac::Enabledisable]`

This feature is not described in the man page. Enable or disable
generation of Kerberos authority

Default value: `undef`

##### `preferred_dc_server`

Data type: `Optional[String[1]]`

Prefer this domain server

Default value: `undef`

##### `restrict_ddns`

Data type: `Optional[Array[String,1]]`

Restrict Dynamic DNS updates to the specified interfaces (e.g. en0,
en1, etc)

Default value: `undef`

##### `namespace`

Data type: `Optional[Managedmac::Namespace]`

Set primary user account naming convention: "forest" or "domain";
"domain" is default

Default value: `undef`

##### `domain_admin_group_list`

Data type: `Optional[Array[String,1]]`

Allow administration by specified Active Directory groups

Default value: `undef`

##### `packet_sign`

Data type: `Optional[Managedmac::Packetsign]`

Packet signing: "allow", "disable" or "require"; "allow" is default

Default value: `undef`

##### `packet_encrypt`

Data type: `Optional[Managedmac::Packetencrypt]`

Packet encryption: "allow", "disable", "require" or "ssl"; "allow"
is default

Default value: `undef`

##### `create_mobile_account_at_login`

Data type: `Optional[Boolean]`

Create mobile account at login

Default value: `undef`

##### `warn_user_before_creating_ma`

Data type: `Optional[Boolean]`

Warn user before creating a Mobile Account

Default value: `undef`

##### `force_home_local`

Data type: `Optional[Boolean]`

Force local home directory

Default value: `undef`

##### `use_windows_unc_path`

Data type: `Optional[Boolean]`

Use UNC path from Active Directory to derive network home location

Default value: `undef`

##### `allow_multi_domain_auth`

Data type: `Optional[Boolean]`

Allow authentication from any domain in the forest

Default value: `undef`

##### `trust_change_pass_interval_days`

Data type: `Optional[Integer]`

How often to require change of the computer trust account password in
days; "0" is disabled

Default value: `undef`

### managedmac::cron

Dynamically create Puppet Cron resources using the Puppet built-in
'create_resources' function.

* **Note** We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

#### Examples

##### defaults.yaml

```puppet
managedmac::cron::jobs:
  logrotate:
    command: '/usr/sbin/logrotate'
    user:    'root'
    hour:    2
    minute:  0
```

##### my_manifest.pp

```puppet
include managedmac::cron
```

##### Create some Hashes

```puppet
$defaults = { user => 'root', hour => 2, minute => 0 }
$jobs = {
   'logrotate' => { 'command' => '/usr/bin/who > /tmp/who.dump' },
}

class { 'managedmac::cron':
  jobs     => $jobs,
  defaults => $defaults,
}
```

#### Parameters

The following parameters are available in the `managedmac::cron` class.

##### `jobs`

Data type: `Hash[String,Hash]`

This is a Hash of Hashes.
The hash should be in the form { title => { parameters } }.
See http://tinyurl.com/7783b9l, and the examples below for details.

Default value: {}

##### `defaults`

Data type: `Hash`

A Hash that defines the default values for the resources created.
See http://tinyurl.com/7783b9l, and the examples below for details.

Default value: {}

### managedmac::desktop

If you just wish to test the functionality of this class, you could also do
something along these lines:

* **Note** All of the parameter defaults are 'undef' so including/containing the class
is not sufficient for confguration. You must activate the params by giving
them a value.

#### Examples

##### defaults.yaml

```puppet
---
managedmac::desktop::override_picture_path:
  "/Library/Desktop Pictures/Abstract.jpg"
managedmac::desktop::locked: true
```

##### my_manifest.pp

```puppet
include managedmac::desktop
```

##### simplte configuration

```puppet
class { 'managedmac::desktop':
  override_picture_path  => '/Library/Desktop Pictures/Abstract.jpg',
  locked                 => true,
}
```

#### Parameters

The following parameters are available in the `managedmac::desktop` class.

##### `override_picture_path`

Data type: `Optional[Stdlib::Absolutepath]`

Set the path of the default desktop picture on OS X.

Default value: `undef`

##### `locked`

Data type: `Optional[Boolean]`

This locks the value of the desktop picture so that users can
select their own picture or not (read Note above).

Default value: `undef`

### managedmac::energysaver

Leverages the Mobileconfig type and provider to configure Energy Saver
settings for Desktops and Laptops.

* **Note** If no parameters are set, removal of the Mobileconfig resource is implicit.

#### Examples

##### defaults.yaml

```puppet
---
managedmac::energysaver::desktop:
   ACPower:
     'Automatic Restart On Power Loss': true
     'Disk Sleep Timer-boolean': true
     'Display Sleep Timer': 15
     'Sleep On Power Button': false
     'Wake On LAN': true
     'System Sleep Timer': 30
   Schedule:
     RepeatingPowerOff:
       eventtype: sleep
       time: 1410
       weekdays: 127
     RepeatingPowerOn:
       eventtype: wakepoweron
       time: 480
       weekdays: 127
managedmac::energysaver::portable:
   ACPower:
     'Automatic Restart On Power Loss': true
     'Disk Sleep Timer-boolean': true
     'Display Sleep Timer': 15
     'Wake On LAN': true
     'System Sleep Timer': 30
   BatteryPower:
     'Automatic Restart On Power Loss': false
     'Disk Sleep Timer-boolean': true
     'Display Sleep Timer': 5
     'System Sleep Timer': 10
     'Wake On LAN': true
```

##### my_manifest.pp

```puppet
include managedmac::activedirectory
```

##### Create an Desktop settings Hash

```puppet
$desktop = {
 "ACPower" => {
   "Automatic Restart On Power Loss" => true,
   "Disk Sleep Timer-boolean"        => true,
   "Display Sleep Timer"             => 15,
   "Sleep On Power Button"           => false,
   "Wake On LAN"                     => true,
   "System Sleep Timer"              => 30,
  },
  "Schedule" => {
    "RepeatingPowerOff" => {
      "eventtype" => "sleep",
      "time"      => 1410,
      "weekdays"  => 127
    },
    "RepeatingPowerOn" => {
      "eventtype" => "wakepoweron",
      "time"      => 480,
      "weekdays"  => 127
    }
  }
}
```

##### Create an Portable settings Hash

```puppet
$portable = {
  "ACPower" => {
    "Automatic Restart On Power Loss" => true,
    "Disk Sleep Timer-boolean"        => true,
    "Display Sleep Timer"             => 15,
    "Wake On LAN"                     => true,
    "System Sleep Timer"              => 30,
  },
  "BatteryPower" => {
    "Automatic Restart On Power Loss" => false,
    "Disk Sleep Timer-boolean"        => true,
    "Display Sleep Timer"             => 5,
    "System Sleep Timer"              => 10,
    "Wake On LAN"                     => true
  }
}
```

##### Invoke the class with params

```puppet
class { 'managedmac::energysaver':
  desktop => $desktop,
  laptop  => $portable,
}
```

#### Parameters

The following parameters are available in the `managedmac::energysaver` class.

##### `desktop`

Data type: `Hash`

The settings to apply for Desktop machines. This is a compound parameter
containing the raw keys/values for configuring EnergySaver. The structure
is rather complex. See the examples for complete details.

Default value: {}

##### `portable`

Data type: `Hash`

The settings to apply for Laptop machines. This is a compound parameter
containing the raw keys/values for configuring EnergySaver. The structure
is rather complex. See the examples for complete details.

Default value: {}

### managedmac::execs

Dynamically create Puppet Exec resources using the Puppet built-in
'create_resources' function.

#### Examples

##### defaults.yaml

```puppet
---
managedmac::execs::commands:
  who_dump:
    command: '/usr/bin/who > /tmp/who.dump'
  ps_dump:
    command: '/bin/ps aux > /tmp/ps.dump'
```

##### my_manifest.pp

```puppet
include managedmac::execs
```

##### Create some Hashes

```puppet
$defaults = { 'returns' => [0,1], }
$commands = {
  'who_dump' => { 'command' => '/usr/bin/who > /tmp/who.dump' },
  'ps_dump'  => { 'command' => '/bin/ps aux  > /tmp/ps.dump' },
}

class { 'managedmac::execs':
  commands  => $commands,
  defaults => $defaults,
}
```

#### Parameters

The following parameters are available in the `managedmac::execs` class.

##### `commands`

Data type: `Hash[String,Hash]`

This is a Hash of Hashes.
The hash should be in the form { title => { parameters } }.
See http://tinyurl.com/7783b9l, and the examples below for details.

Default value: {}

##### `defaults`

Data type: `Hash`

A Hash that defines the default values for the resources created.
See http://tinyurl.com/7783b9l, and the examples below for details.

Default value: {}

### managedmac::files

== Class: managedmac::files

Dynamically create Puppet File resources using the Puppet built-in
'create_resources' function.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

There 2 parameters, the $accounts parameter is required.

[*objects*]
  This is a Hash of Hashes.
  The hash should be in the form { title => { parameters } }.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

[*defaults*]
  A Hash that defines the default values for the resources created.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::files::objects:
  /Users/Shared/example_file_a.txt:
    ensure: file
    owner: root
    group: admin
    mode: '0644'
    content: "This is an example of how to create a file using the \
content parameter."
  /Users/Shared/example_file_b.txt:
    ensure: file
    owner: root
    group: admin
    mode: '0644'
    source: puppet:///modules/my_module/example_file_b.txt
  /Users/Shared/example_directory:
    ensure: directory
    owner: root
    group: admin
    mode: '0755'

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::files

If you just wish to test the functionality of this class, you could also do
something along these lines:

 # Create some Hashes
 $defaults = { 'owner' => 'root', 'group' => 80, }
 $objects = {
    '/Users/Shared/test_file_a.txt' => { 'content' => 'Example A.' },
    '/Users/Shared/test_file_b.txt' => { 'content' => 'Example B.' },
 }

 class { 'managedmac::files':
   objects  => $objects,
   defaults => $defaults,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::files` class.

##### `objects`

Data type: `Any`



Default value: {}

##### `defaults`

Data type: `Any`



Default value: {}

### managedmac::filevault

== Class: managedmac::filevault

Leverages the Mobileconfig type to deploy a FileVault 2 profile. It provides
only a subset of the options available to the profile and does not conform to
the Apple defaults. Read the documentation.

=== Parameters

[*enable*]
  --> Whether to enable FileVault or not.
  Type: Boolean

[*use_recovery_key*]
  Set to true to create a personal recovery key.
  Type: Boolean

[*show_recovery_key*]
  Set to true to display the personal recovery key to the user after
  FileVault is enabled.
  Type: Boolean

[*output_path*]
  Path to the location where the recovery key and computer information
  plist will be stored.
  Type: String

[*use_keychain*]
  If set to true and no certificate information is provided in this
  payload, the keychain already created at
  /Library/Keychains/FileVaultMaster.keychain will be used when the
  institutional recovery key is added.
  Type: Boolean

[*keychain_file*]
  An absolute path or puppet:/// style URI from whence to gather an FVMI.
  It will install and manage /Library/Keychains/FileVaultMaster.keychain.
  Only works when $use_keychain is true.
  Type: String

[*destroy_fv_key_on_standby*]
  Prevent saving the key across standby modes.
  Type: Boolean

[*dont_allow_fde_disable*]
  Prevent users from disabling FDE.
  Type: Boolean

[*remove_fde*]
  Removes FDE if $enable is false and the disk is encrypted.
  Type: Boolean

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
managedmac::filevault::enable: true
managedmac::filevault::use_recovery_key: true
managedmac::filevault::show_recovery_key: true

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::filevault

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::filevault':
   enable => true,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::filevault` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `use_recovery_key`

Data type: `Any`



Default value: `undef`

##### `show_recovery_key`

Data type: `Any`



Default value: `undef`

##### `output_path`

Data type: `Any`



Default value: `undef`

##### `use_keychain`

Data type: `Any`



Default value: `undef`

##### `keychain_file`

Data type: `Any`



Default value: `undef`

##### `destroy_fv_key_on_standby`

Data type: `Any`



Default value: `undef`

##### `dont_allow_fde_disable`

Data type: `Any`



Default value: `undef`

##### `remove_fde`

Data type: `Any`



Default value: `undef`

### managedmac::groups

== Class: managedmac::groups

Dynamically create Puppet Macgroup resources using the Puppet built-in
'create_resources' function.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*accounts*]
  This is a Hash of Hashes.
  The hash should be in the form { title => { parameters } }.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

[*defaults*]
  A Hash that defines the default values for the resources created.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

=== Variables

Not applicable

=== Examples
This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::groups::defaults:
  ensure: present
managedmac::groups::accounts:
  foo_group:
    gid: 998
    users:
      - foo
      - bar
  bar_group:
    gid: 999
    nestedgroups:
      - foo_group

Then simply, create a manifest and include the class...

# Example: my_manifest.pp
include managedmac::groups

If you just wish to test the functionality of this class, you could also do
something along these lines:

# Create some Hashes
$defaults = { 'ensure' => 'present', }
$accounts = {
  'foo_group' => { 'gid' => 511, 'users'        => ['foo'] },
  'bar_group' => { 'gid' => 522, 'nestedgroups' => ['foo_group'] },
}

class { 'managedmac::groups':
  accounts => $accounts,
  defaults => $defaults,
}

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::groups` class.

##### `accounts`

Data type: `Any`



Default value: `undef`

##### `defaults`

Data type: `Any`



Default value: {}

### managedmac::loginhook

== Class: managedmac::loginhook

Simple class for activating or deactivating OS X loginhooks and specifying
a directory of scripts to execute at login time.

How does it work?

Employs Managedmac::Hook defined type to create a master loginhook.
  /etc/masterhooks/loginhook.rb
It then activates the hook by setting the LoginHook key in the root
com.apple.loginwindow preferences domain.

Once the hook is activated, each time a user logs in, the scripts directory
you specify will be searched for executables. From this discovery, a list
of child executables is created. The Master hook will then iterate over this
list, executing each file in turn.

The files are executed in alpha-numeric order.

NOTE: While setting enalbe => true will create the script dir if it doesn't
already exist, setting enable => false will NOT remove directory as it is not
strictly managed. Removal of orphaned scripts is an excercise left up to the
administrator.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*enable*]
  Whether to active the master loginhook or not.
  Type: Boolean

[*scripts*]
  An absolute path on the local machine that will store the scripts you want
  executed by the master loginhook. Optional parameter.
  Type: String

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::loginhook::enable: true
managedmac::loginhook::scripts: /path/to/your/scripts

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::loginhook

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::loginhook':
    enable  => true,
    scripts => '/path/to/your/scripts',
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::loginhook` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `scripts`

Data type: `Any`



Default value: `undef`

### managedmac::loginwindow

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::loginwindow

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::loginwindow':
   loginwindow_text => 'Planet Express Employees Only',
   disable_console_access => true,
   show_name_and_password_fields => true,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::loginwindow` class.

##### `users`

Data type: `Any`



Default value: []

##### `groups`

Data type: `Any`



Default value: []

##### `strict`

Data type: `Any`



Default value: `true`

##### `adminhostinfo`

Data type: `Any`



Default value: `undef`

##### `allow_list`

Data type: `Any`



Default value: []

##### `deny_list`

Data type: `Any`



Default value: []

##### `disable_console_access`

Data type: `Any`



Default value: `undef`

##### `enable_external_accounts`

Data type: `Any`



Default value: `undef`

##### `hide_admin_users`

Data type: `Any`



Default value: `undef`

##### `hide_local_users`

Data type: `Any`



Default value: `undef`

##### `hide_mobile_accounts`

Data type: `Any`



Default value: `undef`

##### `show_network_users`

Data type: `Any`



Default value: `undef`

##### `allow_local_only_users`

Data type: `Any`



Default value: `undef`

##### `loginwindow_text`

Data type: `Any`



Default value: `undef`

##### `restart_disabled`

Data type: `Any`



Default value: `undef`

##### `shutdown_disabled`

Data type: `Any`



Default value: `undef`

##### `sleep_disabled`

Data type: `Any`



Default value: `undef`

##### `retries_until_hint`

Data type: `Any`



Default value: `undef`

##### `show_name_and_password_fields`

Data type: `Any`



Default value: `undef`

##### `show_other_button`

Data type: `Any`



Default value: `undef`

##### `disable_autologin`

Data type: `Any`



Default value: `undef`

##### `disable_guest_account`

Data type: `Any`



Default value: `undef`

##### `auto_logout_delay`

Data type: `Any`



Default value: `undef`

##### `enable_fast_user_switching`

Data type: `Any`



Default value: `undef`

##### `disable_fde_autologin`

Data type: `Any`



Default value: `undef`

### managedmac::logouthook

== Class: managedmac::logouthook

Simple class for activating or deactivating OS X logouthooks and specifying
a directory of scripts to execute at login time.

How does it work?

Employs Managedmac::Hook defined type to create a master logouthook.
  /etc/masterhooks/logouthook.rb
It then activates the hook by setting the LoginHook key in the root
com.apple.loginwindow preferences domain.

Once the hook is activated, each time a user logs in, the scripts directory
you specify will be searched for executables. From this discovery, a list
of child executables is created. The Master hook will then iterate over this
list, executing each file in turn.

The files are executed in alpha-numeric order.

NOTE: While setting enalbe => true will create the script dir if it doesn't
already exist, setting enable => false will NOT remove directory as it is not
strictly managed. Removal of orphaned scripts is an excercise left up to the
administrator.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*enable*]
  Whether to active the master logouthook or not.
  Type: Boolean

[*scripts*]
  An absolute path on the local machine that will store the scripts you want
  executed by the master logouthook. Optional parameter.
  Type: String

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::logouthook::enable: true
managedmac::logouthook::scripts: /path/to/your/scripts

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::logouthook

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::logouthook':
    enable  => true,
    scripts => '/path/to/your/scripts',
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::logouthook` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `scripts`

Data type: `Any`



Default value: `undef`

### managedmac::mcx

== Class: managedmac::mcx

Leverages the Puppet MCX type to deploy some options not available in
Configuration Profiles. If any parameters for this class are defined...

  - Creates a new computer record in the DSLocal node, "mcx_puppet"
  - Applies the specified settings to the new computer record

 By itself this class will force a refresh of MCX policy on each Puppet run.

=== Parameters

[*bluetooth*]
  Enable or disable Bluetooth power and administrative controls.
  Accepts values: on/off, true/false, enable/disable. Values are enforced, so
  if you set it to on/true/enable, users will not be able to turn off the
  service.
  Type: String or Boolean

[*wifi*]
  Enable or disable Airport power and administrative controls.
  Accepts values: on/off, true/false, enable/disable. Values are enforced, so
  if you set it to on/true/enable, users will not be able to turn off the
  service.
  Type: String or Boolean

[*logintiems*]
  Accepts a list of items you want launched at login time. Paths are NOT
  validated.
  Type: Array

[*suppress_icloud_setup*]
  Suppress iCloud Setup dialogue for new users.
  Type: Boolean

[*hidden_preference_panes*]
  A list of hidden System Preferences panes. Prefernce pane names MUST be
  specified by their reverse domain ID. (Eg. com.apple.preferences.icloud)
  Type: Array

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::mcx::bluetooth: on
 managedmac::mcx::wifi: off
 managedmac::mcx::loginitems:
    - /Applications/Chess.app
 managedmac::mcx::suppress_icloud_setup: true
 managedmac::mcx::hidden_preference_panes:
    - com.apple.preferences.icloud

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::mcx

If you just wish to test the functionality of this class, you could also do
something along these lines:

class { 'managedmac::mcx':
  bluetooth   => on,
  wifi        => off,
  loginitems  => ['/path/to/some/file'],
}

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::mcx` class.

##### `bluetooth`

Data type: `Optional[Variant[Boolean,Enum['true','on','enable','false','off','disable']]]`



Default value: `undef`

##### `wifi`

Data type: `Optional[Variant[Boolean,Enum['true','on','enable','false','off','disable']]]`



Default value: `undef`

##### `loginitems`

Data type: `Any`



Default value: []

##### `suppress_icloud_setup`

Data type: `Any`



Default value: `undef`

##### `hidden_preference_panes`

Data type: `Any`



Default value: []

### managedmac::mobileconfigs

== Class: managedmac::mobileconfigs

Dynamically create Puppet Mobileconfig resources using the Puppet built-in
'create_resources' function.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*payloads*]
  This is a Hash of Hashes.
  The hash should be in the form { title => { parameters } }.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

[*defaults*]
  A Hash that defines the default values for the resources created.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

=== Variables

Not applicable

=== Examples
This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::mobileconfigs::defaults:
  description:  'Installed by Puppet.'
  organization: 'Puppet Labs'
managedmac::mobileconfigs::payloads:
  'managedmac.dock.alacarte':
    content:
      largesize: 128
      orientation: left
      tilesize: 128
      autohide: true
      PayloadType: 'com.apple.dock'
    displayname: 'Managed Mac: Dock Settings'

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::mobileconfigs

If you just wish to test the functionality of this class, you could also do
something along these lines:

# Create some Hashes
$defaults = { 'organization' => 'Puppet Labs'}
$payloads = {
  'managedmac.dock.alacarte' => {
    'content' => { 'orientation' => 'left',
       'PayloadType' => 'com.apple.dock'
     },
    'displayname' => 'My Custom Dock',
  },
}

class { 'managedmac::mobileconfigs':
  payloads => $payloads,
  defaults => $defaults,
}

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::mobileconfigs` class.

##### `payloads`

Data type: `Any`



Default value: {}

##### `defaults`

Data type: `Any`



Default value: {}

### managedmac::mounts

== Class: managedmac::mounts

Uses Mobileconfig type to define drives to map at login time.

=== Parameters

[*urls*]
  A list of network mount URIs you wish to open at login. OS X Finder will
  open these URIs in sequence. You can use afp, smb/cifs or http(s) type URLs.
  Type: Array
  Default: empty

=== Variables

Not applicable

=== Examples
This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::mounts::urls:
   - 'https://some.dav.com/web/personal/%short_name%'
   - 'smb://some.windows.com/%short_name%'

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::mounts

If you just wish to test the functionality of this class, you could also do
something along these lines:

 # Create an URLs Array
 $urls = ['afp://some.server.com/some/volume']

 class { 'managedmac::mounts':
   urls => $urls,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::mounts` class.

##### `urls`

Data type: `Any`



Default value: []

### managedmac::ntp

== Class: managedmac::ntp

Activates and configures NTP synchronization.

=== Parameters

This class takes a two parameters:

[*enable*]
  Whether to enable to ntp client or not.
  Type: Bool
  Default: undef

[*servers*]
  A list of NTP servers to use.
  Type: Array
  Default: ['time.sfu.ca']

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::ntp::enable: true
 managedmac::ntp::servers:
   - time.apple.com
   - time1.google.com

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::ntp

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::ntp':
  enable  => true,
  servers => ['time.apple.com', 'time1.google.com'],
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::ntp` class.

##### `enable`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `servers`

Data type: `Array[Stdlib::Fqdn]`



Default value: ['time.apple.com']

### managedmac::portablehomes

== Class: managedmac::portablehomes

Leverages the Mobileconfig type to deploy a Mobility profile capable of
supporting portable home directories.

=== Parameters

This class takes many many parameters. The horror...

[*enable*]
  Enable Portable Home Directory Synchromization
  Accepts a String value of true, false or a Mac OS X major product revision
  number, like '10.9' or '10.10' which will scope the policy
  application to the version specified.
  Default: false
  Type: String

[*menuExtra*]
  Enable the PHD Menu Extra
  Default: on
  Type: String

[*isNewMobileAccount*]
  New Mobile Account
  Set to True if this is a new mobile account that should be synced
  initially.
  Default: false
  Type: Boolean

[*periodicSyncOn*]
  Background Sync On
  Set to True to sync in the background.
  Default: true
  Type: Boolean

[*syncPeriodSeconds*]
  Background Sync Interval
  Background sync interval in seconds.
  Default: 1200
  Type: Integer

[*syncOnChange*]
  Sync On File Change
  Set to True to sync when a file changes.
  Default: false
  Type: Boolean

[*replaceUserSyncList*]
  Override Home Sync Prefs
  Set to True to replace the user's Home Sync preferences with managed
  preferences. Set to False to combine with managed preferences.
  Default: true
  Type: Boolean

[*replaceUserPrefSyncList*]
  Override Preference Sync Prefs
  Set to True to replace the user's Preference sync preferences with
  managed preferences. Set to False to combine them with managed preferences.
  Default: false
  Type: Boolean

[*syncedFolders*]
  Managed Home Sync Items
  Include managed items to sync in the background while the user is
  logged in.
  Default: ['~']
  Tyoe: String

[*syncedPrefFolders*]
  Managed Preference Sync Items
  Include managed items to sync when a user logs in or logs out.
  Default: ['~/Library', '~/Documents/Microsoft User Data']
  Type: Array

[*excludedItems*]
  Managed Home Sync Exclusions
  List managed items to exclude from Home Sync.
  Default: (see class params)
  Type: Array

[*excludedPrefItems*]
  Managed Preference Sync Exclusions
  List managed items to exclude from Preference Sync.
  Default: (see class params)
  Type: Array

[*loginPrefSyncConflictResolution*]
  Login Preference Sync Conflict Resolution
  This setting affects syncing ~/Library at login. Set to
  "mobileHomeWins" to merge homes and have the local (mobile) home win
  conflicts "mobileHomeCopy" to copy the local home to the network home
  "automatic" or "networkHomeWins" to merge homes and have the network home
  win conflicts or "networkHomeCopy" to copy the network home to the local
  home.
  Default: automatic
  Type: String

[*loginNonprefSyncConflictResolution*]
  Login Non-preference Sync Conflict Resolution
  This setting affects syncing everything besides ~/Library at login. Set
  to "showConflictDialogs" to show dialogs when conflicts occur
  "mobileHomeWins" to merge homes and have the local (mobile) home win
  conflicts "mobileHomeCopy" to copy the local home to the network home
  "automatic" or "networkHomeWins" to merge homes and have the network home
  win conflicts or "networkHomeCopy" to copy the network home to the local
  home.
  Default: automatic
  Type: String

[*logoutPrefSyncConflictResolution*]
  Logout Preference Sync Conflict Resolution
  This setting affects syncing ~/Library at logout. Set to
  "mobileHomeWins" to merge homes and have the local (mobile) home win
  conflicts "mobileHomeCopy" to copy the local home to the network home
  "networkHomeWins" to merge homes and have the network home win conflicts or
  "networkHomeCopy" to copy the network home to the local home.
  Default: automatic
  Type: String

[*logoutNonprefSyncConflictResolution*]
  Logout Non-preference Sync Conflict Resolution
  This setting affects syncing everything besides ~/Library at logout.
  Set to "showConflictDialogs" to show dialogs when conflicts occur
  "automatic" or "mobileHomeWins" to merge homes and have the local (mobile)
  home win conflicts "mobileHomeCopy" to copy the local home to the network
  home "networkHomeWins" to merge homes and have the network home win
  conflicts or "networkHomeCopy" to copy the network home to the local home.
  Default: automatic
  Type: String

[*backgroundConflictResolution*]
  Home Sync Conflict Resolution
  This setting affects syncing everything besides ~/Library in the
  background. Set to "automatic" or "showConflictDialogs" to show dialogs
  when conflicts occur "mobileHomeWins" to merge homes and have the local
  (mobile) home win conflicts "mobileHomeCopy" to copy the local home to the
  network home "networkHomeWins" to merge homes and have the network home win
  conflicts or "networkHomeCopy" to copy the network home to the local home.
  Default: automatic
  Type: String

[*syncPreferencesAtLogin*]
  Sync Preference Set During Login
  This setting allows you to sync Preference Sync items during login. Set
  to "automatic" or "sync" to sync Preference Sync items at login\, or
  "dontSync" to not sync Preference Sync items at login.
  Default: automatic
  Type: String

[*syncPreferencesAtLogout*]
  Sync Preference Set During Logout
  This setting allows you to sync Preference Sync items during logout.
  Set to "automatic" or "sync" to sync Preference Sync items at logout\, or
  "dontSync" to not sync Preference Sync items at logout.
  Default: automatic
  Type: String

[*syncPreferencesAtSyncNow*]
  Sync Preferences During Manual Sync
  This setting allows you to sync preferences during a manual sync. Set
  to "automatic" or "sync" to sync preferences during a manual sync\, or
  "dontSync" to not sync preferences during a manual sync.
  Default: automatic
  Type: String

[*syncPreferencesInBackground*]
  Sync Preferences in the Background
  This setting allows you to sync preferences during a background sync.
  Set to "automatic" or "sync" to sync preferences in the background\, or
  "dontSync" to not synchronize preferences in the background.
  Default: automatic
  Type: String

[*syncBackgroundSetAtLogin*]
  Sync Home Set During Login
  This setting allows you to sync Home Sync items during login. Set to
  "automatic" or "sync" to sync Home Sync items at login\, or "dontSync" to
  not sync Home Sync items at login.
  Default: automatic
  Type: String

[*syncBackgroundSetAtLogout*]
  Sync Home Set During Logout
  This setting allows you to sync Home Sync items during logout. Set to
  "automatic" or "sync" to sync Home Sync items at logout\, or "dontSync" to
  not sync Home Sync items at logout.
  Default: automatic
  Type: String

[*syncBackgroundSetAtSyncNow*]
  Sync Preferences During Manual Sync
  This setting allows you to sync Home Sync items during a manual sync.
  Set to "automatic" or "sync" to sync Home Sync items during a manual sync\,
  or "dontSync" to not sync Home Sync items during a manual sync.
  Default: automatic
  Type: String

[*syncBackgroundSetInBackground*]
  Sync Preferences in the Background
  This setting allows you to sync Home Sync items during a background
  sync. Set to "automatic" or "sync" to sync Home Sync items in the
  background\, or "dontSync" to not synchronize Home Sync items in the
  background.
  Default: automatic
  Type: String

[*loginPrefSuppressErrors*]
  Suppress Login Preference Sync Errors
  Set to True to suppress error dialogs during login sync of ~/Library.
  Default: false
  Type: Boolean

[*loginNonprefSuppressErrors*]
  Suppress Login Non-preference Sync Errors
  Set to True to suppress error dialogs during login sync of everything
  besides ~/Library.
  Default: false
  Type: Boolean

[*logoutPrefSuppressErrors*]
  Suppress Logout Preference Sync Errors
  Set to True to suppress error dialogs during logout sync of ~/Library.
  Default: false
  Type: Boolean

[*logoutNonprefSuppressErrors*]
  Suppress Logout Non-preference Sync Errors
  Set to True to suppress error dialogs during logout sync of everything
  besides ~/Library.
  Default: false
  Type: Boolean

[*backgroundSuppressErrors*]
  Suppress Home Sync Errors
  Set to True to suppress error dialogs during home sync.
  Default: false
  Type: Boolean

[*firstSyncSuppressErrors*]
  Suppress Initial Sync Errors
  Set to True to suppress error dialogs during initial sync.
  Default: false
  Type: Boolean

[*syncNowAllPrefsSuppressErrors*]
  Suppress Sync Now Sync Errors
  Set to True to suppress error dialogs during Sync Now.
  Default: false
  Type: Boolean

[*loginPrefSuppressConflicts*]
  Suppress Login Preference Sync Conflicts
  Set to True to suppress conflict dialogs during login sync of ~/Library.
  Default: false
  Type: Boolean

[*loginNonprefSuppressConflicts*]
  Suppress Login Non-preference Sync Conflicts
  Set to True to suppress conflict dialogs during login sync of
  everything besides ~/Library.
  Default: false
  Type: Boolean

[*logoutPrefSuppressConflicts*]
  Suppress Logout Preference Sync Conflicts
  Set to True to suppress conflict dialogs during logout sync of
  ~/Library.
  Default: false
  Type: Boolean

[*logoutNonprefSuppressConflicts*]
  Suppress Logout Non-preference Sync Conflicts
  Set to True to suppress conflict dialogs during logout sync of
  everything besides ~/Library.
  Default: false
  Type: Boolean

[*backgroundSuppressConflicts*]
  Suppress Home Sync Conflicts
  Set to True to suppress conflict dialogs during home sync.
  Default: false
  Type: Boolean

[*firstSyncSuppressConflicts*]
  Suppress Initial Sync Conflicts
  Set to True to suppress conflict dialogs during initial sync.
  Default: false
  Type: Boolean

[*syncNowAllPrefsSuppressConflicts*]
  Suppress Sync Now Conflicts
  Set to True to suppress conflict dialogs during Sync Now.
  Default: false
  Type: Boolean

[*disableFirstSyncCancel*]
  Disable First Time Sync Cancel
  Set to True to disable canceling a first time sync.
  Default: false
  Type: Boolean

[*disableLoginSyncCancel*]
  Disable Login Sync Cancel
  Set to True to disable canceling a login sync.
  Default: false
  Type: Boolean

[*disableLogoutSyncCancel*]
  Disable Logout Sync Cancel
  Set to True to disable canceling a logout sync.
  Default: false
  Type: Boolean

[*loginSyncDialogTimeoutSeconds*]
  Login Dialog Timeout
  Maximum seconds to display login error or conflict dialogs. Set to 0
  for no time limit.
  Default: 0
  Type: Integer

[*logoutSyncDialogTimeoutSeconds*]
  Logout Dialog Timeout
  Maximum seconds to display logout error or conflict dialogs. Set to 0
  for no time limit.
  Default: 0
  Type: Integer

[*progressDelaySeconds*]
  Time To Delay Progress Dialog
  The time in whole seconds that the progress dialog delays for various
  reasons.  The default is set to 0.5 seconds if you do not set this key.
  Default: 2
  Type: Integer

[*alertOnFailedMounts*]
  Alert On Failed Mounts
  Set to True if you want an alert if the network home mount fails.
  Default: false
  Type: Boolean

=== Variables

Not applicable

=== Functions

This class uses two custom functions to reformat file lists:
- portablehomes_excluded_items
- portablehomes_synced_folders

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
managedmac::portablehomes::enable: true
managedmac::portablehomes::menuextra: on
managedmac::portablehomes::backgroundConflictResolution: mobileHomeWins
managedmac::portablehomes::backgroundSuppressErrors: true
managedmac::portablehomes::periodicSyncOn: true
managedmac::portablehomes::syncPeriodSeconds: 720

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::portablehomes

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::portablehomes':
   enable => true,
   menuextra => true,
   backgroundConflictResolution => 'mobileHomeWins',
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::portablehomes` class.

##### `enable`

Data type: `Variant[Boolean,Pattern['^10\.\d{2}\.?\d{0,2}$']]`



Default value: `false`

##### `syncedFolders`

Data type: `Any`



Default value: ['~']

##### `syncedPrefFolders`

Data type: `Any`



Default value: [
    '~/Library',
    '~/Documents/Microsoft User Data'
  ]

##### `excludedItems`

Data type: `Any`



Default value: {
    fullPath => [ '~/.SymAVQSFile',
                  '~/Documents/Microsoft User Data/Entourage Temp',
                  '~/Library/Application Support/SyncServices',
                  '~/Library/Application Support/MobileSync',
                  '~/Library/Caches',
                  '~/Library/Calendars/Calendar Cache',
                  '~/Library/Logs',
                  '~/Library/Mail/AvailableFeeds',
                  '~/Library/Mail/Envelope Index',
                  '~/Library/Preferences/Macromedia/Flash Player',
                  '~/Library/Printers',
                  '~/Library/PubSub/Database',
                  '~/Library/PubSub/Downloads',
                  '~/Library/PubSub/Feeds',
                  '~/Library/Safari/Icons.db',
                  '~/Library/Safari/HistoryIndex.sk',
                  '~/Library/iTunes/iPhone Software Updates',
    ],
    startsWith => [ 'IMAP-',
                    'Exchange-',
                    'EWS-',
                    'Mac-'
    ],
  }

##### `excludedPrefItems`

Data type: `Any`



Default value: {
    fullPath => [ '~/.SymAVQSFile',
                  '~/Documents/Microsoft User Data',
                  '~/Library',
                  '~/NAVMac800QSFile'
    ],
  }

##### `menuExtra`

Data type: `Any`



Default value: `true`

##### `warnOnCreateAllowNever`

Data type: `Any`



Default value: `false`

##### `createAtLogin`

Data type: `Any`



Default value: `true`

##### `createPHDAtLogin`

Data type: `Any`



Default value: `false`

##### `warnOnCreate`

Data type: `Any`



Default value: `false`

##### `isNewMobileAccount`

Data type: `Any`



Default value: `false`

##### `periodicSyncOn`

Data type: `Any`



Default value: `true`

##### `syncPeriodSeconds`

Data type: `Any`



Default value: 1200

##### `syncOnChange`

Data type: `Any`



Default value: `false`

##### `replaceUserSyncList`

Data type: `Any`



Default value: `true`

##### `replaceUserPrefSyncList`

Data type: `Any`



Default value: `false`

##### `loginPrefSyncConflictResolution`

Data type: `Any`



Default value: 'automatic'

##### `loginNonprefSyncConflictResolution`

Data type: `Any`



Default value: 'automatic'

##### `logoutPrefSyncConflictResolution`

Data type: `Any`



Default value: 'automatic'

##### `logoutNonprefSyncConflictResolution`

Data type: `Any`



Default value: 'automatic'

##### `backgroundConflictResolution`

Data type: `Any`



Default value: 'automatic'

##### `syncPreferencesAtLogin`

Data type: `Any`



Default value: 'automatic'

##### `syncPreferencesAtLogout`

Data type: `Any`



Default value: 'automatic'

##### `syncPreferencesAtSyncNow`

Data type: `Any`



Default value: 'automatic'

##### `syncPreferencesInBackground`

Data type: `Any`



Default value: 'automatic'

##### `syncBackgroundSetAtLogin`

Data type: `Any`



Default value: 'automatic'

##### `syncBackgroundSetAtLogout`

Data type: `Any`



Default value: 'automatic'

##### `syncBackgroundSetAtSyncNow`

Data type: `Any`



Default value: 'automatic'

##### `syncBackgroundSetInBackground`

Data type: `Any`



Default value: 'automatic'

##### `loginPrefSuppressErrors`

Data type: `Any`



Default value: `false`

##### `loginNonprefSuppressErrors`

Data type: `Any`



Default value: `false`

##### `logoutPrefSuppressErrors`

Data type: `Any`



Default value: `false`

##### `logoutNonprefSuppressErrors`

Data type: `Any`



Default value: `false`

##### `backgroundSuppressErrors`

Data type: `Any`



Default value: `false`

##### `firstSyncSuppressErrors`

Data type: `Any`



Default value: `false`

##### `syncNowAllPrefsSuppressErrors`

Data type: `Any`



Default value: `false`

##### `loginPrefSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `loginNonprefSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `logoutPrefSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `logoutNonprefSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `backgroundSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `firstSyncSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `syncNowAllPrefsSuppressConflicts`

Data type: `Any`



Default value: `false`

##### `disableFirstSyncCancel`

Data type: `Any`



Default value: `false`

##### `disableLoginSyncCancel`

Data type: `Any`



Default value: `false`

##### `disableLogoutSyncCancel`

Data type: `Any`



Default value: `false`

##### `loginSyncDialogTimeoutSeconds`

Data type: `Any`



Default value: 0

##### `logoutSyncDialogTimeoutSeconds`

Data type: `Any`



Default value: 0

##### `progressDelaySeconds`

Data type: `Any`



Default value: 2

##### `alertOnFailedMounts`

Data type: `Any`



Default value: `false`

### managedmac::propertylists

== Class: managedmac::propertylists

Dynamically create Puppet Propertylist resources using the Puppet built-in
'create_resources' function.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*files*]
  This is a Hash of Hashes.
  The hash should be in the form { title => { parameters } }.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

[*defaults*]
  A Hash that defines the default values for the resources created.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

=== Variables

Not applicable

=== Examples
This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::propertylists::defaults:
  owner: root
  group: wheel
  format: xml
managedmac::propertylists::files:
  '/path/to/a/file.plist':
    content:
      - 'A string.'
      - a_hash_key: 1
      - 42
  '/path/to/another/file.plist':
    content:
      0: 1
      foo: bar
      bar: baz
      an_array:
         - 99

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::propertylists

If you just wish to test the functionality of this class, you could also do
something along these lines:

# Create some Hashes
$defaults = { owner => 'root', method => insert, }
$files = {
  '/this/is/a/file.plist' => {
    'content' => { 'some_key' => 'some_value'},
    format => xml,
  },
}

class { 'managedmac::propertylists':
  files    => $files,
  defaults => $defaults,
}

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::propertylists` class.

##### `files`

Data type: `Any`



Default value: {}

##### `defaults`

Data type: `Any`



Default value: {}

### managedmac::remotemanagement

== Class: managedmac::remotemanagement

Leverages the Remotemanagement type to manage and configure the Apple Remote
Desktop service.

=== Parameters

[*enable*]
  Whether to enable the service or not.
  Type: Boolean

[*allow_all_users*]
  Whether to enable access for ALL local users or not.
  Type: Boolean

[*all_users_privs*]
  The privileges granted to connected users when the allow_all_users param
  is true. Privileges are are represented using a signed integer stored as a
  string. Yes, confusing. Use this Bit map chart to figure it out:

   64 Bit Hex Int Bit Decimal Checkbox Item
   ================================================================
   FFFFFFFFC0000000 0 -1073741824 enabled but nothing set
   FFFFFFFFC0000001 1 -1073741823 send text msgs
   FFFFFFFFC0000002 2 -1073741822 control and observe, show when observing
   FFFFFFFFC0000004 3 -1073741820 copy items
   FFFFFFFFC0000008 4 -1073741816 delete and replace items
   FFFFFFFFC0000010 5 -1073741808 generate reports
   FFFFFFFFC0000020 6 -1073741792 open and quit apps
   FFFFFFFFC0000040 7 -1073741760 change settings
   FFFFFFFFC0000080 8 -1073741696 restart and shutdown

   FFFFFFFF80000002 -2147483646 control and observe don't show when observing
   FFFFFFFFC00000FF -1073741569 all enabled
   FFFFFFFFC00000FF -2147483648 all disabled

  Type: String

[*enable_menu_extra*]
  Whether or not to activate the ARD menu extra.
  Type: Boolean

[*enable_dir_logins*]
  Whether or not to enable the Open Directory group ACLs.
  Type: Boolean

[*allowed_dir_groups*]
  The list of directory groups to use as ARD ACLs.
  Type: Array

[*enable_legacy_vnc*]
  Whether or not to allow legacy VNC connections.
  Type: Boolean

[*vnc_password*]
  The VNC plain text password for connecting. I highly recommend not
  using this.
  Type: String

[*allow_vnc_requests*]
  Whether or not to allow_webm_requests incoming VNC requests.
  Type: Boolean

[*allow_webm_requests*]
  Whether or not to allow_webm_requests incoming WBEM requests.
  Type: Boolean

[*users*]
  A Hash mapping user names to respective ARD privs. Keys are user names
  as String, values are privs as String.
  Example:
  {'fred' => -1073741569, 'daphne' => -2147483646, 'velma' => -1073741822 },
  Type: Hash

[*strict*]
  Controls the exclusivity of the user list. When true, only the listed
  users will be allowed access to ARD. Other users with existing rights will
  have their privs revoked.
  Type: Boolean

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::remotemanagement::enable: true
 managedmac::remotemanagement::users:
   user_a: -1073741569
   user_b: -1073741569
 managedmac::remotemanagement::enable_dir_logins: true
 managedmac::remotemanagement::allowed_dir_groups:
   - com.apple.local.ard_admin
   - com.apple.local.ard_interact
   - com.apple.local.ard_manage
   - com.apple.local.ard_reports

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::remotemanagement

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::remotemanagement':
   enable           => true,
   allow_all_users  => false,
   users            => {'fred' => -1073741569,
      'daphne' => -2147483646, 'velma' => -1073741822 },
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::remotemanagement` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `allow_all_users`

Data type: `Any`



Default value: `false`

##### `all_users_privs`

Data type: `Any`



Default value: '-2147483648'

##### `enable_menu_extra`

Data type: `Any`



Default value: `true`

##### `enable_dir_logins`

Data type: `Any`



Default value: `false`

##### `allowed_dir_groups`

Data type: `Any`



Default value: []

##### `enable_legacy_vnc`

Data type: `Any`



Default value: `false`

##### `vnc_password`

Data type: `Any`



Default value: `undef`

##### `allow_vnc_requests`

Data type: `Any`



Default value: `false`

##### `allow_webm_requests`

Data type: `Any`



Default value: `false`

##### `users`

Data type: `Any`



Default value: {}

##### `strict`

Data type: `Any`



Default value: `true`

### managedmac::screensharing

== Class: managedmac::screensharing

Activates and controls the OS X ScreenSharing service.

IMPORTANT: You cannot enable RemoteManagement and ScreenSharing. If the
catalog contains resources for both these services, the RemoteManagement
service will trump ScreenSharing.

=== Parameters

[*enable*]
  Whether to enable the service or not, true or false.
  Type: Bool
  Default: undef

[*users*]
  A list of user accounts permitted to access the service.
  Type: Array
  Default: []

[*groups*]
  A list of user groups permitted to access the service.
  Type: Array
  Default: ['admin']

[*strict*]
  How to handle membership in the users and nestedgroups arrays. Informs the
  provider whether to merge the specified members into the record, or replace
  them outright. See the Macgroup documentation for details.
  Type: Boolean

=== Variables

None

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::screensharing::enable: true
 managedmac::screensharing::users:
     - leela
     - bender
 managedmac::screensharing::groups:
     - robotmafia

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::screensharing

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::screensharing':
   enable => true,
   users => ['bender', 'fry']
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::screensharing` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `users`

Data type: `Any`



Default value: []

##### `groups`

Data type: `Any`



Default value: ['ABCDEFAB-CDEF-ABCD-EFAB-CDEF00000050']

##### `strict`

Data type: `Any`



Default value: `true`

### managedmac::security

== Class: managedmac::security

Leverages the Mobileconfig type to deploy a Security profile.

All of the parameter defaults are 'undef' so including/containing the class
is not sufficient for confguration. You must activate the params by giving
them a value.

=== Parameters

[*ask_for_password*]
  --> Require a password after sleep or screensaver begins
  Type: Boolean
  Default: undef

[*ask_for_password_delay*]
  --> The interval in seconds before the screensaver demands a password.
  Type: Integer
  Default: undef

[*disable_autologin*]
  --> Prevent users from using autologin during startup.
  Type: Boolean
  Default: undef

[*gatekeeper_enable_assessment*]
  --> Only allow apps and packages from Mac App Store and identified
  developers. If this value is false, Gatekeeper will allow unsigned apps and
  packages to be installed. This equates to the 'Anywhere' UI setting. True
  means only allow trusted apps/packages.
  Type: Boolean
  Default: undef

[*gatekeeper_allow_identified_developers*]
  --> Allow apps/packages from 'Mac App Store' or 'Mac App Store and
  identified developers'. This toggles the Gatekeeper UI: 'Mac App Store' and
  'Mac App Store and identified developers'. False is Mac App Store ONLY.
  True is both.
  Type: Boolean
  Default: undef

[*gatekeeper_disable_override*]
  --> Control disables the Finder's contextual menu that allows bypass of
  System Policy restrictions.
  Type: Boolean
  Default: undef

[*dont_allow_lock_message_ui*]
  --> Don't allow user to set lock message
  Type: Boolean
  Default: undef

[*dont_allow_password_reset_ui*]
  --> Don't allow user to change password
  Type: Boolean
  Default: undef

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::security::ask_for_password: true
 managedmac::security::ask_for_password_delay: 300
 managedmac::security::disable_autologin: true

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::security

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::security':
   ask_for_password        => true,
   ask_for_password_delay  => 300,
   disable_autologin       => true,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::security` class.

##### `ask_for_password`

Data type: `Any`



Default value: `undef`

##### `ask_for_password_delay`

Data type: `Any`



Default value: `undef`

##### `disable_autologin`

Data type: `Any`



Default value: `undef`

##### `gatekeeper_enable_assessment`

Data type: `Any`



Default value: `undef`

##### `gatekeeper_allow_identified_developers`

Data type: `Any`



Default value: `undef`

##### `gatekeeper_disable_override`

Data type: `Any`



Default value: `undef`

##### `dont_allow_lock_message_ui`

Data type: `Any`



Default value: `undef`

##### `dont_allow_password_reset_ui`

Data type: `Any`



Default value: `undef`

### managedmac::softwareupdate

== Class: managedmac::softwareupdate

Abstracts com.apple.SoftwareUpdate PayloadType using Mobileconfig type
and controls keys in global com.apple.SoftwareUpdate and com.apple.storeagent
prefs domain.

=== Parameters

[*catalog_url*]
  The URL for your Apple Software Update server. This will be validated using
  regex, so it needs to at least have the appearnce of being a URL.
  Corresponds to CatalogURL. Managed as a profile.
  Type: String
  e.g. "http://swscan.apple.com/content/catalogs/index-1.sucatalog"

[*allow_pre_release_installation*]
  When false, Macs can no longer install pre-release versions of
  OS X Yosemite from the OS X Beta Program. Corresponds to
  AllowPreReleaseInstallation. Managed as a profile.
  Type: Boolean

[*automatic_update_check*]
  Whether or not to automatically check for Apple Software Updates.
  Corresponds to AutomaticCheckEnabled. Managed in global preferences by
  directly modifying the property list.
  Type: Boolean

[*auto_update_apps*]
  Whether or not to automatically install App Store app updates.
  Corresponds to AutoUpdate. Managed in global preferences by
  directly modifying the com.apple.storeagent or com.apple.commerce
  property list.
  Type: Boolean

[*auto_update_restart_required*]
  Whether or not to automatically install OS X updates.
  Corresponds to AutoUpdateRestartRequired. Managed in global preferences by
  directly modifying the com.apple.storeagent or com.apple.commerce
  property list.
  Type: Boolean

[*automatic_download*]
  Whether or not to automatically download required Apple Software Updates.
  Corresponds to AutomaticDownload. Managed in global preferences by
  directly modifying the property list.
  Type: Boolean

[*config_data_install*]
  Whether or not to automatically download and install updated system data
  files and security updates (Eg. XProtect).
  Corresponds to ConfigDataInstall. Managed in global preferences by
  directly modifying the property list.
  Type: Boolean

[*critical_update_install*]
  Whether or not to automatically download and install critical system
  and security updates (Eg. Security Update 2014-002).
  Corresponds to CriticalUpdateInstall. Managed in global preferences by
  directly modifying the property list.
  Type: Boolean

=== Variables

Not applicable

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::softwareupdate::catalog_url: http://foo.bar.com/whatever.dude
 managedmac::softwareupdate::automatic_update_check: true
 managedmac::softwareupdate::auto_update_apps: true
 managedmac::softwareupdate::automatic_download: false
 managedmac::softwareupdate::config_data_install: false
 managedmac::softwareupdate::critical_update_install: false
 managedmac::softwareupdate::auto_update_restart_required: false

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::softwareupdate

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::softwareupdate':
   catalog_url =>'http://swscan.apple.com/content/catalogs/index-1.sucatalog',
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::softwareupdate` class.

##### `catalog_url`

Data type: `Optional[Stdlib::HTTPUrl]`



Default value: `undef`

##### `allow_pre_release_installation`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `automatic_update_check`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `auto_update_apps`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `automatic_download`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `config_data_install`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `critical_update_install`

Data type: `Optional[Boolean]`



Default value: `undef`

##### `auto_update_restart_required`

Data type: `Optional[Boolean]`



Default value: `undef`

### managedmac::sshd

== Class: managedmac::sshd

Activates and controls the OS X SSH daemon.

=== Parameters

[*enable*]
  Whether to enable the service or not, true or false.
  Type: Bool
  Default: undef

[*sshd_config*]
  Path to file on your Puppet master or a local system.
  Type: String
  Default: undef

[*sshd_banner*]
  Path to file on your Puppet master or a local system.
  Type: String
  Default: undef

[*users*]
  A list of user accounts permitted to access the service.
  Type: Array
  Default: []

[*groups*]
  A list of user groups permitted to access the service.
  Type: Array
  Default: ['admin']

[*strict*]
  How to handle membership in the users and nestedgroups arrays. Informs the
  provider whether to merge the specified members into the record, or replace
  them outright. See the Macgroup documentation for details.
  Type: Boolean

=== Variables

None

=== Examples

This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

 # Example: defaults.yaml
 ---
 managedmac::sshd::enable: true
 managedmac::sshd::sshd_config: puppet:///modules/your_module/sshd_config
 managedmac::sshd::sshd_banner: puppet:///modules/your_module/sshd_banner
 managedmac::sshd::users:
     - leela
     - bender
 managedmac::sshd::groups:
     - robotmafia

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::sshd

If you just wish to test the functionality of this class, you could also do
something along these lines:

 class { 'managedmac::sshd':
   enable => true,
   users => ['bender', 'fry']
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::sshd` class.

##### `enable`

Data type: `Any`



Default value: `undef`

##### `sshd_config`

Data type: `Any`



Default value: `undef`

##### `sshd_banner`

Data type: `Any`



Default value: `undef`

##### `users`

Data type: `Any`



Default value: []

##### `groups`

Data type: `Any`



Default value: ['ABCDEFAB-CDEF-ABCD-EFAB-CDEF00000050']

##### `strict`

Data type: `Any`



Default value: `true`

### managedmac::users

== Class: managedmac::users

Dynamically create Puppet User resources using the Puppet built-in
'create_resources' function.

We do some validation of data, but the usual caveats apply: garbage in,
garbage out.

=== Parameters

[*accounts*]
  This is a Hash of Hashes.
  The hash should be in the form { title => { parameters } }.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

[*defaults*]
  A Hash that defines the default values for the resources created.
  See http://tinyurl.com/7783b9l, and the examples below for details.
  Type: Hash

=== Variables

Not applicable

=== Examples
This class was designed to be used with Hiera. As such, the best way to pass
options is to specify them in your Hiera datadir:

# Example: defaults.yaml
---
managedmac::users::defaults:

lint:ignore:140chars
managedmac::users::accounts:
  foo:
    uid: 505
    iterations: 32786
    password: 4f5942e989e7566955d42421dc4b80c0fa45f6fb2ecbc1026b2183060c8ecbec38582b1a8a6459574ebe1a2d7884d9e8d2a460e8ea3fcf179964a6325a688d7ee7cc60bbb8b8abf252c6a6a799760da0b0fe6e4562f506b2355b03f272580ed9bdbbae55152dfbac066d9c62a799ee184f9904da153a3c20d66657cf3b60d5c8
    salt: 77586e8902d744f650758b402b44e174d7943b10b145c921b3b71affbaf9a32d
  bar:
    uid: 506
    iterations: 32786
    password: a85ea7ce2df74b13be298d6584edbb35558b74616a70e579252416a6b76d0a615c88b7d566280fa5e035e8db7b1a0c4e3ee4b8cd6204652dcb6c89e6e450a60ca7ed0cc9fa545326ca25211e6f600835f50642ab9d407fa30999c68c05b92d9281eff4a66c67f44ed2f8b8eaf8b62283db202bc98e21c0df9a95cf9abb359b69
    salt: 9ab79307a7bfbb293b4f015ae748d227423481bcd4e5801f450697d15fb67144
lint:endignore

Then simply, create a manifest and include the class...

 # Example: my_manifest.pp
 include managedmac::users

If you just wish to test the functionality of this class, you could also do
something along these lines:

 # Create some Hashes
 # Our $defaults specify that users we create are mebers of the Staff group
 # (gid: 20), but individual resources can override this value as per the
 # "bar" user resource -- which gets gid: 80 (admin).
 $defaults = { 'gid' => 20, }
 $accounts = {
    'foo' => { 'uid' => 511, },
    'bar' => { 'uid' => 522, 'gid' => 80},
 }

 class { 'managedmac::users':
   accounts => $accounts,
   defaults => $defaults,
 }

=== Authors

Brian Warsing <bcw@sfu.ca>

=== Copyright

Copyright 2015 SFU, unless otherwise noted.

#### Parameters

The following parameters are available in the `managedmac::users` class.

##### `accounts`

Data type: `Any`



Default value: {}

##### `defaults`

Data type: `Any`



Default value: {}

## Defined types

### managedmac::hook

Definition: managedmac::hook

This class installs a master login or logout hook.

Parameters:
- $enable Whether to activate the master hook or not.
- $scripts An absolute path on the local machine that will store the scripts
you want executed by the master hook. Optional parameter.

Actions:
- Installs a master login or logout hook and tells them where to find the
child scripts


Sample Usage:
managedmac::hook {'login':
  enable  => $enable,
  scripts => $scripts,
}

#### Parameters

The following parameters are available in the `managedmac::hook` defined type.

##### `enable`

Data type: `Any`



##### `scripts`

Data type: `Any`



## Resource types

### dsconfigad

%q(Manage OS X Active Directory binding and configuration options.

  A custom Puppet type for scripted binding and AD plugin configuration
  for OS X using the `dsconfigad` utility.

  Most of the accepted parameters map directly to supported options in
  `dsconfigad` and their descriptions are lifted directly from the man page.

  Example:

    dsconfigad { 'some.domain':
      ensure        => 'present',
      computerid    => 'some_machine',
      username      => 'some_user',
      password      => 'a_password',
      ou            => 'CN=Computers',
      domain        => 'some.domain',
      mobile        => 'disable',
      mobileconfirm => 'disable',
      localhome     => 'disable',
      useuncpath    => 'enable',
      protocol      => 'afp',
      shell         => '/bin/false',
      groups        => ['SOME_DOMAIN\some_group','SOME_DOMAIN\another_group'],
      passinterval  => '0',
    }
)

#### Properties

The following properties are available in the `dsconfigad` type.

##### `ensure`

Valid values: present, absent

The basic property that the resource should be in.

Default value: present

##### `mobile`

Valid values: enable, disable

This flag determines whether the plugin will enable mobile account
support for offline logon.

##### `mobileconfirm`

Valid values: enable, disable

This flag determines whether the plugin will warn the user when a
mobile account is going to be created.

##### `localhome`

Valid values: enable, disable

This flag determines whether the plugin forces all home directories
to be local to the computer (i.e. /Users/username)

##### `useuncpath`

Valid values: enable, disable

This flag determines whether the plugin uses the UNC specified in
the Active Directory when mounting the network home.  If this is dis-
abled, the plugin will look for Apple schema extensions to mount the
home directory.

##### `protocol`

Valid values: smb, afp

This flag determines how a home directory is mounted on the
desktop. By default SMB is used, but AFP can be used for use with
Mac OS X Server or 3rd Party AFP solutions on Windows Servers

##### `sharepoint`

Valid values: enable, disable

Enable or disable mounting of the network home as a sharepoint.

##### `shell`

Use the specified shell (e.g., "/bin/bash") if a shell attribute
does not exist in the directory for the user logging into this computer.
Use a shell value of "none" to disable use of a default shell, preserving
values that are only specified in the directory.

##### `uid`

This specifies the attribute to be used for the UID of the user. By
default, a UID is generated from the Active Directory GUID.

##### `gid`

This specifies the attribute to be used for the GID of the user. By
default, a GID is derived from the primaryGroupID of the user (typically
Domain Users).

##### `ggid`

This specifies the attribute to be used for the GID of the group.
By default, a group GID is generated from the Active Directory GUID of
the group.

##### `authority`

Valid values: enable, disable

This feature is not described in the man page. Enable or disable
generation of Kerberos authority

##### `preferred`

Use the specified server for all Directory lookups and
authentications. If the server is no longer available, it will fail-over
to other servers.

##### `groups`

Use the listed groups to determine who has local administrative
privileges on this computer.

##### `alldomains`

Valid values: enable, disable

This flag determines whether the plugin allows authentication from
any domain in the forest. When this is enabled, individual domains will
not be visible, only "All Domains". If it is disabled, you will have the
ability to select the specific domains that can authenticate to this
computer. Enabled by default.

##### `packetsign`

Valid values: disable, allow, require

By default packet signing is allowed but not required, but can be
required or disabled (for example if debugging a problem).  This ensures
that the data to/from the server is not tampered with by another computer
before received it is received.

##### `packetencrypt`

Valid values: disable, allow, require

By default packet encryption is allowed but not required, but can
be required or disabled (for example if debugging a problem). This
ensures that the data to/from the server is encrypted and signed
guaranteeing the content was not tampered with and cannot be seen by
other computers on the network.

##### `namespace`

Valid values: forest, domain

Sets the primary account username naming convention. By default it
is set to "domain" naming which assumes no conflicting user accounts
across all domains. If your Active Directory forest has conflicts setting
this to "forest" will prefix all usernames with "DOMAIN\" to ensure
unique naming between domains (e.g., "ADDOMAIN\user1").
Warning:  this will change the primary name of the user for all logins.
Changing this setting on an existing system will cause any existing homes
to be unused on the local machine.

##### `passinterval`

Valid values: %r{^\d+$}

Set how often the computer trust account password should be changed
(default 14 days).

##### `restrictddns`

Restricts Dynamic DNS updates to specific interfaces (e.g., en0, en1,
en2, etc.).  To disable restrictions pass "" as the list.

#### Parameters

The following parameters are available in the `dsconfigad` type.

##### `fqdn`

namevar

The fully-qualified DNS name of the Domain to be used when adding
the computer to the Directory (e.g. domain.ads.example.com).

##### `username`

Username of a Network account that has administrative privileges
to add/remove this computer to/from the specified Domain

##### `password`

Password to use in conjunction with the specified username.

##### `computer`

The "computerid" to add the specified Domain

##### `ou`

The LDAP DN of the container to use for adding the computer.  If
this is not specified, it will default to the container "CN=Computers"
within the domain that was specified.
(e.g. "CN=Computers,DC=domain,DC=ads,DC=demo,DC=com"

##### `force`

Valid values: enable, disable

Force the process (i.e., join the existing account or remove the
binding)

Default value: enable

##### `leave`

Valid values: enable, disable

Leaves the current domain (preserving the computer record in the
directory).

Default value: disable

### macgroup

%q(A drop-in replacement for the built-in Puppet Type: Group

  A custom Puppet type for configuring and managing OS X groups.

  Similar to the built-in Puppet type, Macgroup can manage user membership and
  other attributes of DSLocal group records.

  However, unlike the built-in Puppet type, it also supports management of
  nestedgroups records, aka "Groups-in-Group".

  ==== USAGE ====

  macgroup { 'foo':
    ensure => present,
    realname => 'FooGroup',
    comment => 'Installed by Puppet',
    users => ['foo', 'bar', 'baz'],
    nestedgroups => ["ABCDEFAB-CDEF-ABCD-EFAB-CDEF00000050", 'group_two'],
    strict => true,
  }

)

#### Properties

The following properties are available in the `macgroup` type.

##### `ensure`

Valid values: present, absent

The basic property that the resource should be in.

Default value: present

##### `gid`

Valid values: %r{^\d+$}

The numeric ID for the Group.

Corresponds to the PrimaryGroupID/gid attribute.

If you create a new group and do not specify a GID, one will be selected
for you. However, this is not recommended as it cannot guarantee GID
specification across a collection of machines. For example, if the same
resource were applied to two different machines, the GID could not be
guaranteed to be the same on both, unless you were to configure this
parameter.

By the same token, if you do specify a GID parameter, you must ensure
that the GID will not collide with existing groups on the machine --
especially built-ins.

Default is :absent.

##### `users`

The list of users you want added to the group.

Corresponds to the GroupMembership/users attribute.

Membership is managed wholesale, that is, it's purged prior to
modification unless you set strict => false.

Please see the documentation on :strict _before_ using this feature.

To specify users, you pass an Array of user names. The provider will warn
about an invalid user account, but it will apply the configuration
anyway. This is to prevent temporary OpenDirectory or network outages
from wreaking havoc with your Puppet config.

Note: an empty list is not the same as an absent one. An absent list
implies that the attribute is unmanaged, while an empty list _is_ managed
and will create and empty list... Use caution.

Default is :absent (no management)

##### `nestedgroups`

A list of groups you want nested inside the group.

Corresponds to the NestedGroups/nestedgroups attribute.

Note: this attribute lists membership according the record's GeneratedUID,
not the record's' name like the user list.

Membership is managed wholesale, that is, it's purged prior to
modification unless you set strict => false.

Please see the documentation on :strict _before_ using this feature.

To specify nested groups, you pass an Array of:

a) Group Names   (ie. "admin", "staff", etc.)
b) GeneratedUIDs (ie. "ABCDEFAB-CDEF-ABCD-EFAB-CDEF00000050", etc.)
c) A mix of both (ie. "ABCDEFAB-CDEF-ABCD-EFAB-CDEF00000050", "staff")

When you provide a list of group names, the Macgroup type will attempt to
resolve the record to its associated GeneratedUID. This is IMPORTANT to
keep in mind when referring to external node records (ie. LDAP or AD). If
it cannot resolve the record name to GeneratedUID, the Magroup type will
generate a warning and _skip_ configuration of the unresolvable record.

Like the user membership control, this "warn and continue" style of
resource management is sub-optimal, but provides greater resilience
during temporary outages.

For this reason, it is recommended that you list nestegroups according to
their respective GeneratedUIDs and NOT the record names as this will
provide the greatest stability (and less log noise).

Note: an empty list is not the same as an absent one. An absent list
implies that the attribute is unmanaged, while an empty list _is_ managed
and will create and empty list... Use caution.

Default is :absent (no management)

##### `realname`

Optional string value that declares the group's RealName.

Corresponds to the RealName/realname attribute.

Default is :absent.

##### `comment`

String that describes the group's purpose.

Corresponds to the Comment/comment attribute.

Default is :absent.

#### Parameters

The following parameters are available in the `macgroup` type.

##### `name`

namevar

The resource name.

Corresponds to the RecordName/name attribute.

##### `strict`

Valid values: `true`, `false`

How to handle membership in the users and nestedgroups arrays.

A Boolean value that informs the provider whether to merge the
specified members into the record, or replace them outright.

This parameter controls the behavior of BOTH the users and nestedgroups
arrays.

By default, the users and nestedgroups arrays will be PURGED and replaced
by whatever you specify in the resource (ie. strict => true).

Still, this isn't always what you want. Sometimes, you simply want to
ensure that the users/groups you specify in the resource are members, and
ignore any other records in the list(s).

To accomplish this, you can set the strict parameter to false.

Default is :true (purge)

Default value: `true`

### mobileconfig

Dynamically create and manage OS X .mobileconfig profiles

A custom Puppet type for delivering policy via OS X profiles.

When you define a Mobileconfig resource, a .mobileconfig file containing the
settings you specified oin the resource is automatically generated and
installed.

Use of this custom type can be complicated if you don't understand the basic
structure of a .mobileconfig file.

If you need to do some trench work with profiles, I recommend you abstract
the mobileconfig resource by wrappping it in a parameterized Puppet class,
as per the various classes in this module. See the activedirectory.pp file
for an example of this pattern.

==== USAGE ====

# Create an Array of 1 or more PayloadContent Hashes
# - You can stack multiple PayloadContent Hashes inside the Array
# - Each Hash is a single payload
# - Each payload contains key/value pairs representing the settings you want
# to manage
# - You MUST include a PayloadType key for this to work

$content = [{ 'contents-immutable' => true,
  'largesize' => 128,
  'orientation' => 'left',
  'tilesize' => 128,
  'autohide' => true,
  'PayloadType' => 'com.apple.dock'
}]

# The resource name MUST be unique!
# - Only the :name and :content properties are required
mobileconfig { 'puppetlabs.dock.alacarte':
  ensure       => present,
  displayname  => 'Puppet Labs: Dock Settings',
  description  => 'Dock configuration. Installed by Puppet.',
  organization => 'Puppet Labs',
  content      => $options,
}

# You can remove an existing profile just like any other Puppet resource
mobileconfig { 'puppetlabs.dock.alacarte':
  ensure => absent,
}

# Use the puppet resource command to get a list of installed profiles:
`sudo puppet resource mobileconfig`

# Remove the profile using puppet resource...
`sudo puppet resource mobileconfig puppetlabs.dock.alacarte ensure=absent`

#### Properties

The following properties are available in the `mobileconfig` type.

##### `ensure`

Valid values: present, absent

The basic property that the resource should be in.

Default value: present

##### `content`

Array of Hashes containing the payload data for the profile.
Each hash is a key/value store represnting the payload settings
a given PayloadType.

* This content can be complicated to construct manually.
* Required Keys: PayloadIdentifier, PayloadType
* You should always include a unique PayloadIdentifier key/value
  for each Hash in the Array.
* You should always include an appropriate PayloadType key/value
  for each Hash in the Array.
* Other Payload keys (PayloadDescription, etc.) will be ignored.

Corresponds to the PayloadContent key.

##### `description`

String that describes what this profile does.
Corresponds to the PayloadDescription key.

Default value: Installed by Puppet

##### `displayname`

String displayed as the title common name for this profile.
Corresponds to the PayloadDisplayName key.

##### `organization`

String that describes the org that prodcued the profile.
Corresponds to the PayloadOrganization key.

Default value: SFU

##### `removaldisallowed`

Valid values: `true`, `false`

Bool: whether or not to allow the removal of the profile.
Setting this to false means it can be removed. Don't blame me
for the stupid double-negative name, blame Apple.
Corresponds to the PayloadRemovalDisallowed key.

Default value: false

#### Parameters

The following parameters are available in the `mobileconfig` type.

##### `name`

namevar



### property_list

Puppet type for managing OS X PropertyLists.

Suitable for the creation and management of configuration files and
OS X preference domain stores.

Example 1:

  # You can transpose a PropertyList file into a Puppet resource.

  `sudo puppet resource property_list /Library/Preferences/com.apple.loginwindow.plist `

  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    ensure  => 'present',
    content => {'MCXLaunchAfterUserLogin' => 'true',
                'OptimizerLastRunForBuild' => '27396096',
                'OptimizerLastRunForSystem' => '168362496',
                'lastUser' => 'loggedIn',
                'lastUserName' => 'foo'},
    format  => 'binary',
    group   => 'wheel',
    mode    => '0644',
    owner   => 'root',
  }


Example 2:

  # Plist can be managed in whole or part by changing the :method param.
  # See :method documentation for gory details.

  $content = { LoginwindowText => 'A message to you, Rudy.' }

  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    ensure  => present,
    method  => insert,
    content => $content,
  }

Example 3:

  # Use the :defaults provider

  # Avoid problems with cfprefsd and preference domain sychronization by
  # setting the provider parameter to :defaults.

  # The defaults provider will not write directly to disk. Instead, it
  # uses the /usr/bin/defaults utility to sync the data so that the changes
  # are picked up by cfprefsd.

  # NOTE: The content property MUST be a Hash (Dictionary) because that
  # is what OS X defaults demands. If you attempt to use another primitive,
  # Puppet will raise an exception.

  $content = { LoginwindowText => 'A message to you, Rudy.' }

  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    ensure   => present,
    method   => insert,
    content  => $content,
    provider => defaults,
  }

#### Properties

The following properties are available in the `property_list` type.

##### `ensure`

Valid values: present, absent

The basic property that the resource should be in.

Default value: present

##### `owner`

The user to whom the file should belong. Argument should be a user
name. Default is root.

NOTE: The user name is NOT pre-validated.

Default value: root

##### `group`

Which group that should own the file. Argument should be a group
name. Default is wheel.

NOTE: The group name is NOT pre-validated.

Default value: wheel

##### `mode`

The desired permissions for the file using standard four-digit
octal notation.

Default value: 0644

##### `content`

The file's content, whole or in part as a Puppet data type.

Plist content can be managed in whole or in part. Default mode is
wholesale management -- see the :method documentation for exhaustive
details.

Usually, the most convenient of handling this is property is to jam
the desired state into a Puppet variable and use that in the resource
declaration. It's tidy.

Example:

  $content = { LoginwindowText => 'A message to you, Rudy.' }

  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    ensure  => present,
    method  => insert,
    content => $content,
  }

##### `format`

Valid values: xml, binary

The PropertyList format the file should use, binary (default) or
xml.

CAUTION: Setting this parameter can cause undue resource modification
during a Puppet run. Puppet will enforce the file format. If your
selected format differs from what OS X expects it to be, you could get
annoying conversion cycles.

Default value: binary

#### Parameters

The following parameters are available in the `property_list` type.

##### `path`

namevar

The path to the file to manage. Must be fully qualified.

##### `method`

Valid values: replace, insert

Whether to overwrite the property_list, or insert the specified data.

This behaviour demands a detailed explanation, because it's not as simple
as it sounds. First, a little about PropertyLists in general...

As most OS X administrators are aware, PropertyLists usually take the
form of a Dictionary, but they can actually be used to archive ANY of the
primitive data types supported by ObjC: NSDictionary, NSArray, NSData,
NSDate, NSString, etc.

However, the thing that all PropertyLists have in common is that they may
only ever contain a single root object.

What does this mean? It means that if your Plist is storing an Integer,
_that_ is the only value it can hold.

Example:

  <plist version="1.0">
    <integer>1</integer>
  </plist>

That is a valid PropertyList containing a single value.

"But wait!" you say, "I know that I can have mutiple values in a
PropertyList, just look at any of the files stored in
/Library/Preferences."

This is true, you can store as many values as you wish a in PropertyList,
but just like plain old XML, you can only ever have ONE ROOT ELEMENT.

This means that in order to store multiple values in a PropertyList, you
will need to use a compound data type such as a <\dict> or an <\array>
as the ROOT element.

Example (dictionary):

  <plist version="1.0">
    <dict>
      <key>foo</key>
      <integer>99</integer>
      <key>bar</key>
      <integer>42</integer>
      <key>baz</key>
      <string>This is a string.</string>
    </dict>
  </plist>

Example (array):

  <plist version="1.0">
    <array>
      <string>A string.</string>
      <string>Another string.</string>
      <integer>42</integer>
    </array>
  </plist>

These complex data types allow you store multiple values as a single
root object. In addition, you can also modify the elements in an Array or
Dictionary without disturbing the remaining data.

This is where the :method parameter for this Puppet Type comes into play.

We use it to control two modes of operation for the creation and
management of the PropertyList on disk:

1. Replace (:replace)

This is the default mode. In this mode, the data you specify in Puppet or
another data source like Hiera, will be the only data in the Plist. It
is absolute. If the Plist you are managing deviates in ANY way from the
content specified in your Puppet resource, it will be overwritten.

For example, let's say you are managing a Plist in /Library/Preferences
(this is _not_ a good idea, see :providers documentation) named...

com.apple.loginwindow.plist

By managing this file in :replace mode, you are committed to managing the
file in totality -- every key, every value. But, as we know, this file
gets modified any time somebody logs in or out of the computer.

This means that on any given Puppet run, this file is extremely likely to
be reverted to the originally desired state.

This is a good thing, if that's what you want, but chances are this
behaviour is less than optimal (noisy and unnecessary).

Maybe you only wish to manage particular keys/values inside the file???

2. Insert (:insert)

This is an optional mode and it must be expressly set in your resource
declaration. Examine this Puppet code...

  # A Puppet Hash ("dictionary") containing a single key/value combo. In
  # this case, we want to control the value LoginwindowText and present
  # our users with a "special" message.
  $content = { LoginwindowText => 'A message to you, Rudy.' }

  # Here is our resource declaration, but notice that we have set the
  # :method parameter to :insert
  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    ensure  => present,
    group   => 'staff',
    mode    => '0644',
    owner   => 'root',
    content => $content,
    method  => insert,
  }

So, what does this accomplish?

What we are in fact saying to Puppet is the following...

  "I want to make sure this file exists. If not, create it."
  "I want to make sure this file's owner, group and mode are set
  accordingly."
  "I want to make sure the content of this file is a dictionary that
   contains the key 'LoginwindowText' and that key has a value of...
   'A message to you, Rudy.'
   You can ignore the other portions of the file's content. Thanks."

This is what :insert mode does. It inserts the content you define into
the file leaving the other stuff unmolested.

Of course, if you try to insert data and there is a mismatch between the
root objects in the PropertyList, you will get an error. For example,
let's say we tried the following...

  # A simple Puppet Array variable, full of Integers
  $content = [1, 2, 3, 4, 5]

  # Some non-essential params removed
  property_list { '/Library/Preferences/com.apple.loginwindow.plist':
    content => $content,
    method  => insert,
  }

Here, we know com.apple.loginwindow.plist exists -- it always does.
We also know that it's root object is a <\dict> -- it always is.

But we were careless and we have attempted to use an Array as the root
object while in :insert mode. In :replace mode, this would work the
contents of the file would be overwritten with the $content array
destroying the integrity of the file and possibly destabilizing the
system -- don't do this -- but it _would_ work.

However, in :insert mode you would receive an error that looks like
this...

  'Could not evaluate: no implicit conversion of Array into Hash'

This means you tried to replace the root object (currently a <\dict>)
with an <\array> and Puppet has stopped you. Thanks, Puppet.

Now, this whole scenario is a bit far-fetched, but it does illustrate
the need to be DECISIVELY AWARE of HOW and WHAT you are
choosing to manage, so you can avoid errors (and poetntial disasters).

There is one more intersting characteristic of managing PropertyLists
that has to do with Arrays as root objects...

Arrays are ordered lists.

  $content = [1, 2, 3, 4, 5]

This array has 5 elements. Let's create a PropertyList with it.

  property_list { '/Users/Shared/foo.plist':
    format  => xml,
    content => $content,
    method  => insert,
  }

Ok, great. We should now have a PropertyList that looks like this...

  <plist version="1.0">
    <array>
      <integer>1</integer>
      <integer>2</integer>
      <integer>3</integer>
      <integer>4</integer>
      <integer>5</integer>
    </array>
  </plist>

So, what if we want to delete a value? Let's say we want to remove the
fourth element of the array...

  $content = [1, 2, 3, 5]

  property_list { '/Users/Shared/foo.plist':
    format  => xml,
    content => $content,
    method  => insert,
  }

Now let's inspect our PropertyList...

  <plist version="1.0">
    <array>
      <integer>1</integer>
      <integer>2</integer>
      <integer>3</integer>
      <integer>5</integer>
      <integer>5</integer>
    </array>
  </plist>

What happened??? Do you see the problem?

Let's break it down...

1. We are in insert mode, this implies we are going to ignore extraneous
data and only manage what we are told to.

2. Arrays are ordered lists. The only thing unique about array elements
is its index (ie. what order it is in).

3. We shortened the $content array from 5 elements to 4 elements! When
we did this, we essentially redefined what the first four elements of the
root object Array should be and since we were in :insert mode, the
leftover element got ignored -- even though it was a duplicate value!!!

Weird as it may seem, this is how :insert mode operates on Arrays as root
objects. You need to be aware of this behaviour.

Luckily, most PropertyLists DO NOT use Arrays as root objects. Off the
top my head I can only think of one that does and it is not something
that can be managed as a file-on-disk. FTR: the output of
/usr/sbin/system_profiler produces an XML PropertyList that uses an
Array as the root object.

Default value: replace

### remotemanagement

Manage Mac OS X Apple Remote Desktop client settings.
remotemanagement { 'apple_remote_desktop':
  ensure            => 'running',
  allow_all_users   => false,
  enable_menu_extra => false,
  users             => {
    'fred'   => -1073741569,
    'daphne' => -2147483646,
    'velma'  => -1073741822
  },
}

=== EXAMPLE USER PRIVILEGE SETTINGS ===
Bit map for naprivs
-------------------
64 Bit Hex Int Bit Decimal Checkbox Item
================================================================
FFFFFFFFC0000000 0 -1073741824 enabled but nothing set
FFFFFFFFC0000001 1 -1073741823 send text msgs
FFFFFFFFC0000002 2 -1073741822 control and observe, show when observing
FFFFFFFFC0000004 3 -1073741820 copy items
FFFFFFFFC0000008 4 -1073741816 delete and replace items
FFFFFFFFC0000010 5 -1073741808 generate reports
FFFFFFFFC0000020 6 -1073741792 open and quit apps
FFFFFFFFC0000040 7 -1073741760 change settings
FFFFFFFFC0000080 8 -1073741696 restart and shutdown

FFFFFFFF80000002 -2147483646 control and observe don't show when observing
FFFFFFFFC00000FF -1073741569 all enabled

#### Properties

The following properties are available in the `remotemanagement` type.

##### `ensure`

Valid values: stopped, running

The basic property that the resource should be in.

##### `allow_all_users`

Valid values: `true`, `false`

Whether to enable ARD access for ALL local users of the machine.

Default value: false

##### `all_users_privs`

The privleges to use when the :allow_all_users bool is set to true.

##### `enable_menu_extra`

Valid values: `true`, `false`

Enable or disable the ARD menu extra in the user's task bar.

Default value: false

##### `enable_dir_logins`

Valid values: `true`, `false`

Allow the special directory groups to be used.

Default value: false

##### `allowed_dir_groups`

A list of directory groups allowed to access to the service.

##### `enable_legacy_vnc`

Valid values: `true`, `false`

Enable or disable legacy VNC support. Just a bad idea all around.

Default value: false

##### `vnc_password`

The password used for VNC, stored as plain text!
Thinking this is not a good idea? Yeah, me too. Don't use it.

##### `allow_vnc_requests`

Valid values: `true`, `false`

Allow VNC guests to request permission?

Default value: false

##### `allow_wbem_requests`

Valid values: `true`, `false`

Allow incoming WBEM requests over IP.

Default value: false

##### `users`

A hash containing a username to privilege mapping.

#### Parameters

The following parameters are available in the `remotemanagement` type.

##### `name`

namevar

Name of the setup.

Default value: apple_remote_desktop

##### `strict`

Valid values: `true`, `false`

Setting this to true will explicitly define which users are permitted RemoteManagement privs. This
means that any account not defined in the :users hash will have their privs revoked if present.

Default value: `true`

## Functions

### compact_hash

Type: Ruby 3.x API

Hash keys with empty or undef values are deleted. Returns resulting Hash.

#### `compact_hash()`

Hash keys with empty or undef values are deleted. Returns resulting Hash.

Returns: `Any`

### portablehomes_excluded_items

Type: Ruby 3.x API

Returns a Array of properly formatted excludeItems Hashes.

#### `portablehomes_excluded_items()`

Returns a Array of properly formatted excludeItems Hashes.

Returns: `Any`

### portablehomes_synced_folders

Type: Ruby 3.x API

Returns a Array of properly formatted syncedFolder Hashes.

#### `portablehomes_synced_folders()`

Returns a Array of properly formatted syncedFolder Hashes.

Returns: `Any`

### process_dsconfigad_params

Type: Ruby 3.x API

Returns a Hash for Dsconfigad type suitable for consumption by
`create_resources`. It will compact the data and transform Booleans into the
preferred enable|disable toggle. Accepts a single argument, a Hash.

#### `process_dsconfigad_params()`

Returns a Hash for Dsconfigad type suitable for consumption by
`create_resources`. It will compact the data and transform Booleans into the
preferred enable|disable toggle. Accepts a single argument, a Hash.

Returns: `Any`

### process_mcx_options

Type: Ruby 3.x API

Returns a com.apple.ManagedClient.preferences Payload.

#### `process_mcx_options()`

Returns a com.apple.ManagedClient.preferences Payload.

Returns: `Any`

### process_mobileconfig_params

Type: Ruby 3.x API

Returns a Payload Array for Mobileconfig type. Accepts a Hash. Each key is a
string representing the PayloadType key. The value of said key is the payload
data. Keys with empty or :undef values will be expunged.

#### `process_mobileconfig_params()`

Returns a Payload Array for Mobileconfig type. Accepts a Hash. Each key is a
string representing the PayloadType key. The value of said key is the payload
data. Keys with empty or :undef values will be expunged.

Returns: `Any`

### process_mounts

Type: Ruby 3.x API

Returns a Payload Hash of properly formatted mounts. Expects Array.

#### `process_mounts()`

Returns a Payload Hash of properly formatted mounts. Expects Array.

Returns: `Any`

### validate_raw_constructor

Type: Ruby 3.x API

Specialized function used to validate raw constructor class resource hashes.
Expects the value of each key in the resource param to be Hash. If the value is
not a Hash it's rejected. If the the Hash is exhausted, the resource is
"validated".

#### `validate_raw_constructor()`

Specialized function used to validate raw constructor class resource hashes.
Expects the value of each key in the resource param to be Hash. If the value is
not a Hash it's rejected. If the the Hash is exhausted, the resource is
"validated".

Returns: `Any`

### version_compare

Type: Ruby 3.x API

Expects a pair of version strings. Returns Fixnum: -1 (<), 0 (=) or 1 (>)

#### `version_compare()`

Expects a pair of version strings. Returns Fixnum: -1 (<), 0 (=) or 1 (>)

Returns: `Any`

## Data types

### Managedmac::Enabledisable

Enable/Disable data type

Alias of `Enum['enable', 'disable']`

### Managedmac::Mountstyle

Mount style for user home directory

Alias of `Enum['afp', 'smb']`

### Managedmac::Namespace

Allowed namespace for ad

Alias of `Enum['forest', 'domain']`

### Managedmac::Packetencrypt

Packet encryption type

Alias of `Enum['allow', 'disable', 'require', 'ssl']`

### Managedmac::Packetsign

Packet signing type

Alias of `Enum['allow', 'disable', 'require']`

### Managedmac::Universalboolean

Universal boolean. Can take true/false as string or type

Alias of `Variant[Boolean, Enum['true','false']]`

